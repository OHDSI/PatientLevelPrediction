<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding Custom Patient-Level Prediction Algorithms • PatientLevelPrediction</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding Custom Patient-Level Prediction Algorithms">
<meta property="og:description" content="PatientLevelPrediction">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PatientLevelPrediction</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">6.3.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/InstallationGuide.html">Get started</a>
</li>
<li>
  <a href="../articles/Videos.html">Videos</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AddingCustomFeatureEngineering.html">Adding Custom Feature Engineering Functions</a>
    </li>
    <li>
      <a href="../articles/AddingCustomModels.html">Adding Custom Patient-Level Prediction Algorithms</a>
    </li>
    <li>
      <a href="../articles/AddingCustomSamples.html">Adding Custom Sampling Functions</a>
    </li>
    <li>
      <a href="../articles/AddingCustomSplitting.html">Adding Custom Data Splitting Functions</a>
    </li>
    <li>
      <a href="../articles/BestPractices.html">Best Practice Research</a>
    </li>
    <li>
      <a href="../articles/BuildingMultiplePredictiveModels.html">Automatically Build Multiple Patient-Level Predictive Models</a>
    </li>
    <li>
      <a href="../articles/BuildingPredictiveModels.html">Building patient-level predictive models</a>
    </li>
    <li>
      <a href="../articles/CreatingLearningCurves.html">Creating Learning Curves</a>
    </li>
    <li>
      <a href="../articles/CreatingNetworkStudies.html">Making  patient-level predictive network study packages</a>
    </li>
    <li>
      <a href="../articles/InstallationGuide.html">Patient-Level Prediction Installation Guide</a>
    </li>
    <li>
      <a href="../articles/Videos.html">Demo Videos</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.ohdsi.org/past-events/patient-level-prediction/" class="external-link">Tutorial</a>
</li>
<li>
  <a href="../articles/BestPractices.html">Best Practices</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/PatientLevelPrediction" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adding Custom Patient-Level Prediction
Algorithms</h1>
                        <h4 data-toc-skip class="author">Jenna Reps,
Martijn J. Schuemie, Patrick B. Ryan, Peter R. Rijnbeek</h4>
            
            <h4 data-toc-skip class="date">2023-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/PatientLevelPrediction/blob/HEAD/vignettes/AddingCustomModels.Rmd" class="external-link"><code>vignettes/AddingCustomModels.Rmd</code></a></small>
      <div class="hidden name"><code>AddingCustomModels.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{Adding Custom Patient-Level Prediction Algorithms}
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how you can add your own custom algorithms in
the Observational Health Data Sciencs and Informatics (OHDSI) <a href="http://github.com/OHDSI/PatientLevelPrediction" class="external-link"><code>PatientLevelPrediction</code></a>
package. This allows you to fully leverage the OHDSI
PatientLevelPrediction framework for model development and validation.
This vignette assumes you have read and are comfortable with building
single patient level prediction models as described in the <a href="https://github.com/OHDSI/PatientLevelPrediction/blob/master/inst/doc/BuildingPredictiveModels.pdf" class="external-link"><code>BuildingPredictiveModels</code>
vignette</a>.</p>
<p><strong>We invite you to share your new algorithms with the OHDSI
community through our <a href="http://github.com/OHDSI/PatientLevelPrediction" class="external-link">GitHub
repository</a>.</strong></p>
</div>
<div class="section level2">
<h2 id="algorithm-code-structure">Algorithm Code Structure<a class="anchor" aria-label="anchor" href="#algorithm-code-structure"></a>
</h2>
<p>Each algorithm in the package should be implemented in its own
&lt;Name&gt;.R file, e.g. KNN.R, containing a set&lt;Name&gt; function,
a fit&lt;Name&gt; function and a predict&lt;Name&gt; function.
Occasionally the fit and prediction functions may be reused (if using an
R classifier see RClassifier.R or if using a scikit-learn classifier see
SklearnClassifier.R). We will now describe each of these functions in
more detail below.</p>
<div class="section level3">
<h3 id="set">Set<a class="anchor" aria-label="anchor" href="#set"></a>
</h3>
<p>The set&lt;Name&gt; is a function that takes as input the different
hyper-parameter values to do a grid search when training. The output of
the functions needs to be a list as class <code>modelSettings</code>
containing:</p>
<ul>
<li>param - all the combinations of the hyper-parameter values
input</li>
<li>fitFunction - a string specifying what function to call to fit the
model</li>
</ul>
<p>The param object can have a setttings attribute containing any extra
settings. For example to specify the model name and the seed used for
reproducibility:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  seed <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  modelName <span class="op">=</span> <span class="st">"Special classifier"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>For example, if you were adding a model called madeUp that has two
hyper-parameters then the set function should be:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">setMadeUp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span>, <span class="va">b</span><span class="op">=</span><span class="fl">2</span>, <span class="va">seed</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># add input checks here...</span></span>
<span>  </span>
<span>  <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>      a<span class="op">=</span><span class="va">a</span>, </span>
<span>      b<span class="op">=</span><span class="va">b</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    modelName <span class="op">=</span> <span class="st">"Made Up"</span>,</span>
<span>    requiresDenseMatrix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    seed <span class="op">=</span> <span class="va">seed</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># now create list of all combinations:</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fitFunction <span class="op">=</span> <span class="st">'fitMadeUp'</span>, <span class="co"># this will be called to train the made up model</span></span>
<span>    param <span class="op">=</span> <span class="va">param</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'modelSettings'</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit">Fit<a class="anchor" aria-label="anchor" href="#fit"></a>
</h3>
<p>This function should train your custom model for each parameter
entry, pick the best parameters and train a final model for that
setting.</p>
<p>The fit&lt;Model&gt; should have as inputs:</p>
<ul>
<li>trainData - a list containing the covariateData, labels and folds
for the training population</li>
<li>param - the hyper-parameters as a list of all combinations</li>
<li>search - the type of hyper-parameter search</li>
<li>analysisId - an identifier for the analysis</li>
</ul>
<p>The fit function should return a list of class <code>plpModel</code>
with the following objects:</p>
<ul>
<li>model - a trained model (or location of the model if it is not an R
object)</li>
<li>prediction - a data.frame object with the trainData$labels plus an
extra column with the name ‘value’ corresponding to the predicted risk
of having the outcome during the time-at-risk.</li>
<li>preprocessing - the settings required to preprocess the data when
applying the model
<ul>
<li>featureEngineering - the feature engineering settings e.g.,
attr(trainData<span class="math inline">\(covariateData,
"metaData")\)</span>featureEngineering,</li>
<li>tidyCovariates - the preprocessing settings e.g.,
attr(trainData<span class="math inline">\(covariateData,
"metaData")\)</span>tidyCovariateDataSettings,</li>
<li>requireDenseMatrix - does the model require a dense matrix? e.g.,
attr(param, ‘settings’)$requiresDenseMatrix,</li>
</ul>
</li>
<li>modelDesign - a list containing:
<ul>
<li>targetId - the id of the target cohort</li>
<li>outcomeId - the id of the outcome cohort</li>
<li>plpDataSettings - the plpData settings e.g., attr(trainData,
“metaData”)$plpDataSettings</li>
<li>covariateSettings - the covariate settings e.g., attr(trainData,
“metaData”)$covariateSettings</li>
<li>populationSettings - the population settings e.g., attr(trainData,
“metaData”)$populationSettings,</li>
<li>featureEngineeringSettings - the feature engineering settings e.g.,
attr(trainData<span class="math inline">\(covariateData,
"metaData")\)</span>featureEngineeringSettings,</li>
<li>preprocessSettings - the preprocessing settings e.g.,
attr(trainData<span class="math inline">\(covariateData,
"metaData")\)</span>preprocessSettings,</li>
<li>modelSettings = a list containing: model (model name), param (the
hyper-parameter search list), finalModelParameters (the final model
hyper-parameters), extraSettings (any extra settings)</li>
<li>splitSettings - the split settings e.g., attr(trainData,
“metaData”)$splitSettings,</li>
<li>sampleSettings - the sample settings e.g., attr(trainData,
“metaData”)$sampleSettings</li>
</ul>
</li>
<li>trainDetails - a list containing:
<ul>
<li>analysisId - the identifier for the analysis</li>
<li>developmentDatabase - the database used to develop the model</li>
<li>attrition - the attrition</li>
<li>trainingTime - how long it took to train the model</li>
<li>trainingDate - date of model training</li>
<li>hyperParamSearch - the hyper-parameter search used to train the
model</li>
<li>any other objects specific to training</li>
</ul>
</li>
<li>covariateImportance - a data.frame containing the columns
‘covariateId’, ‘covariateValue’ (the variable importance) and ‘columnId’
(the column number that the variable need to be mapped to when
implementing the model)</li>
</ul>
<p>In additon the plpModel requires two attributes:</p>
<ul>
<li>predictionFunction - the name of the function used to make
predictions</li>
<li>modelType - whether the model is ‘binary’ or ‘survival’</li>
</ul>
<p>For example
<code>attr(result, 'predictionFunction') &lt;- 'madeupPrediction'</code>
means when the model is applied to new data, the ‘madeupPrediction’
function is called to make predictions. If this doesnt exist, then the
model will fail. The other attribute is the modelType
<code>attr(result, 'modelType') &lt;- 'binary'</code> this is needed
when evaluating the model to ensure the correct evaluation is applied.
Currently the evaluation supports ‘binary’ and ‘survival’ modelType.</p>
<p>Note: If a new modelType is desired, then the evalaution code within
PatientLevelPrediction must be updated to specify how the new type is
evaluated. This requires making edits to PatientLevelPrediction and then
making a pull request to the PatientLevelPrediction github. The
evaluation cannot have one off customization because the evaluation must
be standardized to enable comparison across similar models.</p>
<p>A full example of a custom ‘binary’ classifier fit function is:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitMadeUp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">trainData</span>, <span class="va">modelSettings</span>, <span class="va">search</span>, <span class="va">analysisId</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">param</span> <span class="op">&lt;-</span> <span class="va">modelSettings</span><span class="op">$</span><span class="va">param</span></span>
<span>  </span>
<span>  <span class="co"># **************** code to train the model here</span></span>
<span>  <span class="co"># trainedModel &lt;- this code should apply each hyper-parameter combination   </span></span>
<span>  <span class="co"># (param[[i]]) using the specified search (e.g., cross validation)</span></span>
<span>  <span class="co">#                 then pick out the best hyper-parameter setting</span></span>
<span>  <span class="co">#                 and finally fit a model on the whole train data using the </span></span>
<span>  <span class="co">#                 optimal hyper-parameter settings</span></span>
<span>  <span class="co"># ****************</span></span>
<span>  </span>
<span>  <span class="co"># **************** code to apply the model to trainData</span></span>
<span>  <span class="co"># prediction &lt;- code to apply trainedModel to trainData</span></span>
<span>  <span class="co"># ****************</span></span>
<span>  </span>
<span>  <span class="co"># **************** code to get variable importance (if possible)</span></span>
<span>  <span class="co"># varImp &lt;- code to get importance of each variable in trainedModel</span></span>
<span>  <span class="co"># ****************</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># construct the standard output for a model:</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">trainedModel</span>,</span>
<span>                 prediction <span class="op">=</span> <span class="va">prediction</span>, <span class="co"># the train and maybe the cross validation predictions for the trainData</span></span>
<span>                 preprocessing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   featureEngineering <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span><span class="op">$</span><span class="va">covariateData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">featureEngineering</span>,</span>
<span>      tidyCovariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span><span class="op">$</span><span class="va">covariateData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">tidyCovariateDataSettings</span>, </span>
<span>      requireDenseMatrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span><span class="op">$</span><span class="va">requiresDenseMatrix</span>,</span>
<span>      </span>
<span>                 <span class="op">)</span>,</span>
<span>    modelDesign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      outcomeId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">outcomeId</span>,</span>
<span>      targetId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">targetId</span>,</span>
<span>      plpDataSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">plpDataSettings</span>,</span>
<span>      covariateSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">covariateSettings</span>,</span>
<span>      populationSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">populationSettings</span>,</span>
<span>      featureEngineeringSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span><span class="op">$</span><span class="va">covariateData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">featureEngineeringSettings</span>,</span>
<span>      prerocessSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span><span class="op">$</span><span class="va">covariateData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">prerocessSettings</span>, </span>
<span>      modelSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span><span class="op">$</span><span class="va">modelName</span>, <span class="co"># the model name</span></span>
<span>        param <span class="op">=</span> <span class="va">param</span>,</span>
<span>        finalModelParameters <span class="op">=</span> <span class="va">param</span><span class="op">[[</span><span class="va">bestInd</span><span class="op">]</span><span class="op">]</span>, <span class="co"># best hyper-parameters</span></span>
<span>        extraSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      splitSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">splitSettings</span>,</span>
<span>      sampleSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">sampleSettings</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    trainDetails <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      analysisId <span class="op">=</span> <span class="va">analysisId</span>,</span>
<span>      developmentDatabase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">cdmDatabaseSchema</span>,</span>
<span>      attrition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trainData</span>, <span class="st">"metaData"</span><span class="op">)</span><span class="op">$</span><span class="va">attrition</span>, </span>
<span>      trainingTime <span class="op">=</span> <span class="va">timeToTrain</span>, <span class="co"># how long it took to train the model</span></span>
<span>      trainingDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      hyperParamSearch <span class="op">=</span> <span class="va">hyperSummary</span> <span class="co"># the hyper-parameters and performance data.frame</span></span>
<span>    <span class="op">)</span>,</span>
<span>    covariateImportance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">trainData</span><span class="op">$</span><span class="va">covariateData</span><span class="op">$</span><span class="va">covariateRef</span>, <span class="va">varImp</span>, by<span class="op">=</span><span class="st">'covariateId'</span><span class="op">)</span> <span class="co"># add variable importance to covariateRef if possible</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'plpModel'</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">'predictionFunction'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'madeupPrediction'</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">'modelType'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'binary'</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span></span></code></pre></div>
<p>You could make the fitMadeUp function cleaner by adding helper
function in the MadeUp.R file that are called by the fit function (for
example a function to run cross validation). It is important to ensure
there is a valid prediction function (the one specified by
<code>attr(result, 'predictionFunction') &lt;- 'madeupPrediction'</code>
is <code>madeupPrediction()</code>) as specified below.</p>
</div>
<div class="section level3">
<h3 id="predict">Predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h3>
<p>The prediction function takes as input the plpModel returned by fit,
new data and a corresponding cohort. It returns a data.frame with the
same columns as cohort but with an additional column:</p>
<ul>
<li>value - the predicted risk from the plpModel for each patient in the
cohort</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">madeupPrediction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">plpModel</span>, <span class="va">data</span>, <span class="va">cohort</span><span class="op">)</span><span class="op">{</span> </span>
<span></span>
<span>  <span class="co"># ************* code to do prediction for each rowId in cohort</span></span>
<span>  <span class="co"># predictionValues &lt;- code to do prediction here returning the predicted risk</span></span>
<span>  <span class="co">#               (value) for each rowId in cohort </span></span>
<span>  <span class="co">#**************</span></span>
<span>  </span>
<span>  <span class="va">prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">cohort</span>, <span class="va">predictionValues</span>, by<span class="op">=</span><span class="st">'rowId'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">prediction</span>, <span class="st">"metaData"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>modelType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">plpModel</span>, <span class="st">'modelType'</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">prediction</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="algorithm-example">Algorithm Example<a class="anchor" aria-label="anchor" href="#algorithm-example"></a>
</h2>
<p>Below a fully functional algorithm example is given, however we
highly recommend you to have a look at the available algorithms in the
package (see GradientBoostingMachine.R for the set function,
RClassifier.R for the fit and prediction function for R
classifiers).</p>
<div class="section level3">
<h3 id="set-1">Set<a class="anchor" aria-label="anchor" href="#set-1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">setMadeUp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, <span class="va">b</span><span class="op">=</span><span class="fl">2</span>, <span class="va">seed</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># add input checks here...</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>      a<span class="op">=</span><span class="va">a</span>, </span>
<span>      b<span class="op">=</span><span class="va">b</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">param</span>, <span class="st">'settings'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    modelName <span class="op">=</span> <span class="st">"Made Up"</span>,</span>
<span>    requiresDenseMatrix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    seed <span class="op">=</span> <span class="va">seed</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># now create list of all combinations:</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fitFunction <span class="op">=</span> <span class="st">'fitMadeUp'</span>, <span class="co"># this will be called to train the made up model</span></span>
<span>    param <span class="op">=</span> <span class="va">param</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'modelSettings'</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-1">Fit<a class="anchor" aria-label="anchor" href="#fit-1"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fitMadeUp <span class="ot">&lt;-</span> <span class="cf">function</span>(trainData, modelSettings, search, analysisId){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set the seed for reproducibility</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  param <span class="ot">&lt;-</span> modelSettings<span class="sc">$</span>param</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">attr</span>(param, <span class="st">'settings'</span>)<span class="sc">$</span>seed)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add folds to labels:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  trainData<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">merge</span>(trainData<span class="sc">$</span>labels, trainData<span class="sc">$</span>folds, <span class="at">by=</span> <span class="st">'rowId'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert data into sparse R Matrix:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  mappedData <span class="ot">&lt;-</span> <span class="fu">toSparseM</span>(trainData,<span class="at">map=</span><span class="cn">NULL</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  matrixData <span class="ot">&lt;-</span> mappedData<span class="sc">$</span>dataMatrix</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> mappedData<span class="sc">$</span>labels</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  covariateRef <span class="ot">&lt;-</span> mappedData<span class="sc">$</span>covariateRef</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#============= STEP 1 ======================================</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pick the best hyper-params and then do final training on all data...</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(<span class="st">'Cross validation'</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  param.sel <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    param, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x){</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        made_up_model, </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">param =</span> x, </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">final =</span> F, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> matrixData, </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> labels</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>          )  </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  hyperSummary <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(param.sel, <span class="cf">function</span>(x) x<span class="sc">$</span>hyperSum))</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  hyperSummary <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(hyperSummary)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  hyperSummary<span class="sc">$</span>auc <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(param.sel, <span class="cf">function</span>(x) x<span class="sc">$</span>auc)) </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  param.sel <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(param.sel, <span class="cf">function</span>(x) x<span class="sc">$</span>auc))</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  bestInd <span class="ot">&lt;-</span> <span class="fu">which.max</span>(param.sel)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get cross val prediction for best hyper-parameters</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> param.sel[[bestInd]]<span class="sc">$</span>prediction</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  prediction<span class="sc">$</span>evaluationType <span class="ot">&lt;-</span> <span class="st">'CV'</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(<span class="st">'final train'</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  finalResult <span class="ot">&lt;-</span> <span class="fu">do.call</span>(</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    made_up_model, </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> param[[bestInd]], </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">final =</span> T, </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> matrixData, </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> labels</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      )  </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  trainedModel <span class="ot">&lt;-</span> finalResult<span class="sc">$</span>model</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prediction risk on training data:</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  finalResult<span class="sc">$</span>prediction<span class="sc">$</span>evaluationType <span class="ot">&lt;-</span> <span class="st">'Train'</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get CV and train prediction</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prediction, finalResult<span class="sc">$</span>prediction)</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  varImp <span class="ot">&lt;-</span> covariateRef <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">collect</span>()</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># no feature importance available</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  vqrImp<span class="sc">$</span>covariateValue <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a> timeToTrain <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() <span class="sc">-</span> start</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># construct the standard output for a model:</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">model =</span> trainedModel,</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prediction =</span> prediction, </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">preprocessing =</span> <span class="fu">list</span>(</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">featureEngineering =</span> <span class="fu">attr</span>(trainData<span class="sc">$</span>covariateData, <span class="st">"metaData"</span>)<span class="sc">$</span>featureEngineering,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">tidyCovariates =</span> <span class="fu">attr</span>(trainData<span class="sc">$</span>covariateData, <span class="st">"metaData"</span>)<span class="sc">$</span>tidyCovariateDataSettings, </span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">requireDenseMatrix =</span> <span class="fu">attr</span>(param, <span class="st">'settings'</span>)<span class="sc">$</span>requiresDenseMatrix,</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelDesign =</span> <span class="fu">list</span>(</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">outcomeId =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>outcomeId,</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">targetId =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>targetId,</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">plpDataSettings =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>plpDataSettings,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">covariateSettings =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>covariateSettings,</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">populationSettings =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>populationSettings,</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">featureEngineeringSettings =</span> <span class="fu">attr</span>(trainData<span class="sc">$</span>covariateData, <span class="st">"metaData"</span>)<span class="sc">$</span>featureEngineeringSettings,</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">prerocessSettings =</span> <span class="fu">attr</span>(trainData<span class="sc">$</span>covariateData, <span class="st">"metaData"</span>)<span class="sc">$</span>prerocessSettings, </span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">modelSettings =</span> <span class="fu">list</span>(</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="fu">attr</span>(param, <span class="st">'settings'</span>)<span class="sc">$</span>modelName, <span class="co"># the model name</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">param =</span> param,</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">finalModelParameters =</span> param[[bestInd]], <span class="co"># best hyper-parameters</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">extraSettings =</span> <span class="fu">attr</span>(param, <span class="st">'settings'</span>)</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">splitSettings =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>splitSettings,</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">sampleSettings =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>sampleSettings</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">trainDetails =</span> <span class="fu">list</span>(</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">analysisId =</span> analysisId,</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">developmentDatabase =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>cdmDatabaseSchema,</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">attrition =</span> <span class="fu">attr</span>(trainData, <span class="st">"metaData"</span>)<span class="sc">$</span>attrition, </span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">trainingTime =</span> timeToTrain, <span class="co"># how long it took to train the model</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">trainingDate =</span> <span class="fu">Sys.Date</span>(),</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">hyperParamSearch =</span> hyperSummary <span class="co"># the hyper-parameters and performance data.frame</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">covariateImportance =</span> <span class="fu">merge</span>(trainData<span class="sc">$</span>covariateData<span class="sc">$</span>covariateRef, varImp, <span class="at">by=</span><span class="st">'covariateId'</span>) <span class="co"># add variable importance to covariateRef if possible</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>    covariateImportance <span class="ot">=</span> varImp</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>  <span class="er">)</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(result) <span class="ot">&lt;-</span> <span class="st">'plpModel'</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(result, <span class="st">'predictionFunction'</span>) <span class="ot">&lt;-</span> <span class="st">'madeupPrediction'</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(result, <span class="st">'modelType'</span>) <span class="ot">&lt;-</span> <span class="st">'binary'</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="helpers">Helpers<a class="anchor" aria-label="anchor" href="#helpers"></a>
</h3>
<p>In the fit model a helper function <code>made_up_model</code> is
called, this is the function that trains a model given the data, labels
and hyper-parameters.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">made_up_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">param</span>, <span class="va">data</span>, <span class="va">final</span><span class="op">=</span><span class="cn">F</span>, <span class="va">labels</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">final</span><span class="op">==</span><span class="cn">F</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># add value column to store all predictions</span></span>
<span>    <span class="va">labels</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">labels</span>, <span class="st">"metaData"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>modelType <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">foldPerm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># this holds CV aucs</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">index</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">madeup</span><span class="fu">::</span><span class="fu">model</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">!=</span><span class="va">index</span>,<span class="op">]</span>, <span class="co"># remove left out fold</span></span>
<span>        y <span class="op">=</span> <span class="va">labels</span><span class="op">$</span><span class="va">outcomeCount</span><span class="op">[</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">!=</span><span class="va">index</span><span class="op">]</span>,</span>
<span>        a <span class="op">=</span> <span class="va">param</span><span class="op">$</span><span class="va">a</span>, </span>
<span>        b <span class="op">=</span> <span class="va">param</span><span class="op">$</span><span class="va">b</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># predict on left out fold</span></span>
<span>      <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">data</span><span class="op">[</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">==</span><span class="va">index</span>,<span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">labels</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">==</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pred</span></span>
<span>      </span>
<span>      <span class="co"># calculate auc on help out fold  </span></span>
<span>      <span class="va">aucVal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeAuc.html">computeAuc</a></span><span class="op">(</span><span class="va">labels</span><span class="op">[</span><span class="va">labels</span><span class="op">$</span><span class="va">index</span><span class="op">==</span><span class="va">index</span>,<span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">foldPerm</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">foldPerm</span>,<span class="va">aucVal</span><span class="op">)</span>    </span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeAuc.html">computeAuc</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span> <span class="co"># overal AUC</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">madeup</span><span class="fu">::</span><span class="fu">model</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">data</span>, </span>
<span>      y <span class="op">=</span> <span class="va">labels</span><span class="op">$</span><span class="va">outcomeCount</span>,</span>
<span>      a <span class="op">=</span> <span class="va">param</span><span class="op">$</span><span class="va">a</span>,</span>
<span>      b <span class="op">=</span> <span class="va">param</span><span class="op">$</span><span class="va">b</span></span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">data</span><span class="op">)</span></span>
<span>    <span class="va">labels</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">pred</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">labels</span>, <span class="st">"metaData"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>modelType <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span> </span>
<span>    <span class="va">auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeAuc.html">computeAuc</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span></span>
<span>    <span class="va">foldPerm</span> <span class="op">&lt;-</span> <span class="va">auc</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="va">model</span>,</span>
<span>    auc <span class="op">=</span> <span class="va">auc</span>,</span>
<span>    prediction <span class="op">=</span> <span class="va">labels</span>,</span>
<span>    hyperSum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, fold_auc <span class="op">=</span> <span class="va">foldPerm</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="predict-1">Predict<a class="anchor" aria-label="anchor" href="#predict-1"></a>
</h3>
<p>The final step is to create a predict function for the model. In the
example above the predeiction function
<code>attr(result, 'predictionFunction') &lt;- 'madeupPrediction'</code>
was madeupPrediction, so a <code>madeupPrediction</code> function is
required when applying the model. The predict function needs to take as
input the plpModel returned by the fit function, new data to apply the
model on and the cohort specifying the patients of interest to make the
prediction for.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">madeupPrediction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">plpModel</span>, <span class="va">data</span> , <span class="va">cohort</span><span class="op">)</span><span class="op">{</span> </span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="st">'plpData'</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># convert</span></span>
<span>    <span class="va">matrixObjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/toSparseM.html">toSparseM</a></span><span class="op">(</span></span>
<span>      plpData <span class="op">=</span> <span class="va">data</span>, </span>
<span>      cohort <span class="op">=</span> <span class="va">cohort</span>,</span>
<span>      map <span class="op">=</span> <span class="va">plpModel</span><span class="op">$</span><span class="va">covariateImportance</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"columnId"</span>, <span class="st">"covariateId"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">newData</span> <span class="op">&lt;-</span> <span class="va">matrixObjects</span><span class="op">$</span><span class="va">dataMatrix</span></span>
<span>    <span class="va">cohort</span> <span class="op">&lt;-</span> <span class="va">matrixObjects</span><span class="op">$</span><span class="va">labels</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">newData</span> <span class="op">&lt;-</span> <span class="va">data</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">plpModel</span><span class="op">)</span> <span class="op">==</span> <span class="st">'plpModel'</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="va">plpModel</span><span class="op">$</span><span class="va">model</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">model</span> <span class="op">&lt;-</span> <span class="va">plpModel</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">cohort</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># fix the rowIds to be the old ones</span></span>
<span>  <span class="co"># now use the originalRowId and remove the matrix rowId</span></span>
<span>  <span class="va">cohort</span> <span class="op">&lt;-</span> <span class="va">cohort</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="st">"rowId"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>rowId <span class="op">=</span> <span class="st">"originalRowId"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cohort</span>, <span class="st">"metaData"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>modelType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">plpModel</span>, <span class="st">'modelType'</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">cohort</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>As the madeup model uses the standard R prediction, it has the same
prediction function as xgboost, so we could have not added a new
prediction function and instead made the predictionFunction of the
result returned by fitMadeUpModel to
<code>attr(result, 'predictionFunction') &lt;- 'predictXgboost'</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>Considerable work has been dedicated to provide the
<code>PatientLevelPrediction</code> package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"PatientLevelPrediction"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## To cite PatientLevelPrediction in publications use:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Reps JM, Schuemie MJ, Suchard MA, Ryan PB, Rijnbeek P (2018). "Design</span></span>
<span><span class="co">##   and implementation of a standardized framework to generate and</span></span>
<span><span class="co">##   evaluate patient-level prediction models using observational</span></span>
<span><span class="co">##   healthcare data." _Journal of the American Medical Informatics</span></span>
<span><span class="co">##   Association_, *25*(8), 969-975.</span></span>
<span><span class="co">##   &lt;https://doi.org/10.1093/jamia/ocy032&gt;.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Article{,</span></span>
<span><span class="co">##     author = {J. M. Reps and M. J. Schuemie and M. A. Suchard and P. B. Ryan and P. Rijnbeek},</span></span>
<span><span class="co">##     title = {Design and implementation of a standardized framework to generate and evaluate patient-level prediction models using observational healthcare data},</span></span>
<span><span class="co">##     journal = {Journal of the American Medical Informatics Association},</span></span>
<span><span class="co">##     volume = {25},</span></span>
<span><span class="co">##     number = {8},</span></span>
<span><span class="co">##     pages = {969-975},</span></span>
<span><span class="co">##     year = {2018},</span></span>
<span><span class="co">##     url = {https://doi.org/10.1093/jamia/ocy032},</span></span>
<span><span class="co">##   }</span></span></code></pre>
<p><strong>Please reference this paper if you use the PLP Package in
your work:</strong></p>
<p><a href="http://dx.doi.org/10.1093/jamia/ocy032" class="external-link">Reps JM, Schuemie
MJ, Suchard MA, Ryan PB, Rijnbeek PR. Design and implementation of a
standardized framework to generate and evaluate patient-level prediction
models using observational healthcare data. J Am Med Inform Assoc.
2018;25(8):969-975.</a></p>
<p>This work is supported in part through the National Science
Foundation grant IIS 1251151.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenna Reps, Martijn Schuemie, Marc Suchard, Patrick Ryan, Peter Rijnbeek, Egill Fridgeirsson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
